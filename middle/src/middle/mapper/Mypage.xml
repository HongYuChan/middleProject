<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">



<mapper namespace="middle.mapper.Mypagemapper">
	<cache />
	
	<select id="member" parameterType="int" resultType="Member">
		select * from member where user_id = #{user_id}
	</select>
	
 	<select id="myprofile" parameterType="int" resultType="Member_Product">
 		select  m.user_id, m.id, m.password, m.nickname, m.email, m.photne_number m.address, m.holding_coin, m.evaluation, m.name,
				p.product_id, p.product_name, p.title, p.sale_date, p.buter_id, i.image_url
		from member m inner join product p on m.user_id = p.user_id inner join images i on p.product_id = i.product_id
 		where m.user_id = #{user_id}
 	</select>
 	
 	<select id="myproduct" parameterType="int" resultType="Product">
 		select * from product where user_id = #{user_id}
 	</select>
 	
 	<update id="modifypassword" parameterType="Member">
 		update member set password=#{password} where user_id = #{user_id}
 	</update>
 	
 	<update id="modifynickname" parameterType="Member">
 		update member set nickname=#{nickname} where user_id = #{user_id}
 	</update>
 	
 	<update id="modifyemail" parameterType="Member">
 		update member set email=#{email} where user_id = #{user_id}
 	</update>
 	
 	<delete id="deletemember" parameterType="int">
 		delete from member where user_id = #{user_id}
 	</delete>
	
	<select id="sellList" parameterType="int" resultType="Product">
		select * from product where user_id = #{user_id}
	</select>
	
	<select id="buyList" parameterType="int" resultType="Product">
		select * from product where buyer_id = #{user_id}
	</select>
	
	<select id="recentTrade" parameterType="int" resultType="Product">
		select * from (select * from product where user_id = #{user_id} OR buyer_id = #{user_id} 
		order by sale_date desc) where rownum = 1;
	</select>
	
	<select id="memberImg" parameterType="int" resultType="Member_img">
		select i.image_id, i.user_id, i.url from member m inner join member_img i on m.user_id = i.user_id
		where m.user_id = #{user_id}
	</select>
</mapper>















